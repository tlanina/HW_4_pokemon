---
title: "HW_4 - –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–∫–µ–º–æ–Ω—ñ–≤"
author: "Tanya Lanina"
format: html
execute:
  echo: false
  warning: false
  message: false
editor_options: 
  chunk_output_type: console
---
–£ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ —è –¥–æ—Å–ª—ñ–¥–∂—É—é –¥–∞–Ω—ñ –ø—Ä–æ –ø–æ–∫–µ–º–æ–Ω—ñ–≤ –∑ –Ω–∞–±–æ—Ä—É **TidyTuesday**.  
–ü–æ–¥–∏–≤–∏–º–æ—Å—è —è–∫ –∑–º—ñ–Ω—é–≤–∞–ª–∏—Å—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–æ–∫–µ–º–æ–Ω—ñ–≤ –º—ñ–∂ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º–∏, –∑–Ω–∞–π–¥–µ–º–æ –Ω–∞–π–º–∞—Å–∏–≤–Ω—ñ—à–∏—Ö, –∞ —Ç–∞–∫–æ–∂ –ø–æ—Ä—ñ–≤–Ω—è—î–º–æ —Ç–∏–ø Fairy –∑ —ñ–Ω—à–∏–º–∏.

```{r}
#| echo: false
library(tidyverse)
library(tidytuesdayR)
library(RColorBrewer)
library(ggplot2)
library(plotly)
tuesdata <- tidytuesdayR::tt_load('2025-04-01')
pokemon_df <- tuesdata$pokemon_df
```
## ‚öîÔ∏è 1. –°–µ—Ä–µ–¥–Ω—è –∞—Ç–∞–∫–∞ –∑–∞ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º–∏

–ú–∏ –º–∞—î–º–æ –∫–æ–ª–æ–Ω–∫—É –ø–æ–∫–µ–º–æ–Ω—ñ–≤ –∑–∞ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º–∏ `generation_id`. –î–∞–≤–∞–π—Ç–µ –¥—ñ–∑–Ω–∞—î–º–æ—Å—å —è–∫ –µ–≤–æ–ª—é—Ü—ñ–æ–Ω—É–≤–∞–ª–∞ **—Å–µ—Ä–µ–¥–Ω—è –∞—Ç–∞–∫–∞** –≤ —Ä—ñ–∑–Ω–∏—Ö –ø–æ–∫–æ–ª—ñ–Ω–Ω—è—Ö 

```{r}
#| echo: false
pokemon_df |>
  group_by(generation_id) |>
  summarise(mean_attack = mean(attack, na.rm = TRUE)) |>
  ggplot(aes(x = factor(generation_id), y = mean_attack, fill = factor(generation_id))) +
  geom_col() +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal() +
  labs(
    title = "–°–µ—Ä–µ–¥–Ω—ñ–π –ø–æ–∫–∞–∑–Ω–∏–∫ –∞—Ç–∞–∫–∏ –∑–∞ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º–∏",
    x = "–ü–æ–∫–æ–ª—ñ–Ω–Ω—è", y = "–°–µ—Ä–µ–¥–Ω—è –∞—Ç–∞–∫–∞"
  )
```
### –í–∏—Å–Ω–æ–≤–æ–∫

–ó –∫–æ–∂–Ω–∏–º –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º –±–∞–ª–∞–Ω—Å —Å–∏–ª–∏ —Ç—Ä–æ—Ö–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è. –ê–ª–µ –≤–ø—Ä–∏–Ω—Ü–∏–ø—ñ, –∑–º—ñ–Ω–∏ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è –Ω—ñ—è–∫ –Ω–µ –≤–ø–ª–∏–≤–∞–ª–∞ –Ω–∞ —Å–µ—Ä–µ–¥–Ω—é –∞—Ç–∞–∫—É.

## üçî 2. –¢–æ–ø-20 —Ç–æ–≤—Å—Ç—É–Ω—ñ–≤ –∑–∞ —ñ–Ω–¥–µ–∫—Å–æ–º –º–∞—Å–∏ —Ç—ñ–ª–∞ (BMI)

–©–æ–± –∑–Ω–∞–π—Ç–∏ —Ç–æ–≤—Å—Ç—É–Ω—ñ–≤ —Å–µ—Ä–µ–¥ –ø–æ–∫–µ–º–æ–Ω—ñ–≤, –æ–±—á–∏—Å–ª–∏–º–æ –ø–æ–∫–∞–∑–Ω–∏–∫ BMI (–≤–∞–≥–∞/–∑—Ä—ñ—Å—Ç¬≤) —ñ –ø–æ–¥–∏–≤–∏–º–æ—Å—è —Ö—Ç–æ –ø–æ—Ç—Ä–∞–ø–∏—Ç—å –¥–æ —Ç–æ–ø-20 –Ω–∞–π–≤–∞–∂—á–∏—Ö –∑–∞ –ø—Ä–æ–ø–æ—Ä—Ü—ñ—è–º–∏.

```{r}
pokemon_bmi <- pokemon_df |>
  mutate(
    bmi = weight/(height**2)
  )

top10_bmi <- pokemon_bmi |>
  arrange(desc(bmi)) |>
  slice(2:21)

top10_bmi |> 
  ggplot(aes(x = bmi, y = pokemon, color = type_1)) +
    geom_point(size = 5) +
    scale_fill_brewer(palette = "Set4") +
    theme_minimal() +
    labs(
      title = "–¢–æ–ø-20 –Ω–∞–π–º–∞—Å–∏–≤–Ω—ñ—à–∏—Ö –ø–æ–∫–µ–º–æ–Ω—ñ–≤ (–∑–∞ BMI)",
      x = "–Ü–Ω–¥–µ–∫—Å –º–∞—Å–∏ —Ç—ñ–ª–∞ (BMI)",
      y = "–ü–æ–∫–µ–º–æ–Ω",
      color = "–¢–∏–ø"
    )


```

–ú–æ–∂–µ–º–æ –±–∞—á–∏—Ç–∏, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫—ñ—Å—å –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫—ñ. –¶–µ —á–µ—Ä–µ–∑ —Ç–µ —â–æ –∑—Ä—ñ—Å—Ç –¥–µ—è–∫–∏—Ö –ø–æ–∫–µ–º–æ–Ω—ñ–≤ –¥—É–∂–µ –º–∞–ª–∏–π(0.3). –¢–æ–º—É –∫–æ–ª–∏ –º–∏ –¥—ñ–ª–∏–º–æ –Ω–∞ 0.09 –≤–∏—Ö–æ–¥–∏—Ç—å —Ç–∞–∫–µ –≤–µ–ª–∏–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è. –û—Ç–∂–µ, –Ω–∞–¥—Ç–æ –º–∞–ª–µ–Ω—å–∫–∏–π –∑—Ä—ñ—Å—Ç —à—Ç—É—á–Ω–æ ‚Äú–∑–∞–≤–∏—â—É—î‚Äù –ø–æ–∫–∞–∑–Ω–∏–∫ BMI. –ú–æ–∂–Ω–∞ –æ–±–º–µ–∂–∏—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É –º–∞—Å–∏ —Ç—ñ–ª–∞ –∞–±–æ –∂ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫, —â–æ –¥–ª—è –ø–æ–∫–µ–º–æ–Ω—ñ–≤ —î —Å–≤—ñ–π –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π BMI, –∞ –Ω–µ —Ç–∞–∫–∏–π —è–∫ –≤ –ª—é–¥–µ–π.

## üßö 3. Fairy –ø—Ä–æ—Ç–∏ –≤—Å—ñ—Ö.

–¶—ñ–∫–∞–≤–æ, —è–∫ –ø–æ–∫–µ–º–æ–Ω–∏ —Ç–∏–ø—É Fairy –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥ —Ä–µ—à—Ç–∏ –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:
`HP`, `Attack` —Ç–∞ `Special Attack`.

```{r}
fairy_vs_others <- pokemon_df |>
  group_by(group = if_else(type_1 == "fairy", "Fairy", "–Ü–Ω—à—ñ"))|>
  summarise(
    mean_hp = mean(hp, na.rm = TRUE),
    mean_attack = mean(attack, na.rm = TRUE),
    mean_special_attack = mean(special_attack, na.rm = TRUE),
    count = n()
  ) |>
  pivot_longer(
    cols = starts_with("mean_"),
    names_to = "attribute",
    values_to = "mean_value"
  )


ggplot(fairy_vs_others, aes(x = attribute, y = mean_value, fill = group)) +
  geom_col(position = "dodge", width = 0.7) +
  scale_fill_manual(values = c("lightpink", "lightblue")) +
  theme_minimal(base_size = 14) +
  labs(
    title = "–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–∏–ª–∏ –ø–æ–∫–µ–º–æ–Ω—ñ–≤ —Ç–∏–ø—É Fairy –∑ —ñ–Ω—à–∏–º–∏",
    x = "–ü–æ–∫–∞–∑–Ω–∏–∫",
    y = "–°–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è",
    fill = "–ì—Ä—É–ø–∞"
  ) +
  scale_x_discrete(
    labels = c(
      mean_hp = "HP",
      mean_attack = "Attack",
      mean_special_attack = "Special Attack"
    )
  )

```

–ü–æ–∫–µ–º–æ–Ω–∏ —Ç–∏–ø—É Fairy –∑–∞–≥–∞–ª–æ–º –º–∞—é—Ç—å –Ω–∏–∂—á—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∞—Ç–∞–∫–∏, –∞–ª–µ —á–∞—Å—Ç–æ –∫–æ–º–ø–µ–Ω—Å—É—é—Ç—å —Ü–µ –≤–∏—Å–æ–∫–∏–º `Special Attack` —ñ –∫—Ä–∞—â–∏–º HP.



